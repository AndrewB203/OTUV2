%% Лабораторная работа №8: Синтез регуляторов линейных систем

% Очистка рабочего пространства и закрытие всех графиков
clear all;
close all;
clc;

%% Параметры системы (вариант 1)
k = 1;          % Коэффициент усиления объекта
T = 0.5;        % Постоянная времени T
T1 = 0.5;       % Постоянная времени T1 (вариант 1)

%% 1. Создание передаточной функции объекта управления
num = [k];                          % Числитель передаточной функции
den = [T*T1, T+T1, 1, 0];           % Знаменатель передаточной функции
WO = tf(num, den);                   % Передаточная функция объекта

disp('Передаточная функция объекта управления:');
disp(WO);

%% 2. Исследование системы без регулятора (П-регулятор)
% Запуск SISOTool с передаточной функцией объекта
sisotool(WO);

% В открывшемся окне SISOTool:
% 1. Добавить ограничения: Settling time < 10s, Overshoot < 10%
% 2. Попробовать подобрать коэффициент усиления перемещением полюсов
% 3. Если не удается удовлетворить требования - перейти к ПД-регулятору

%% 3. Синтез ПД-регулятора
% Параметры ПД-регулятора (начальные значения)
kp = 1;         % Пропорциональный коэффициент
Td = 0.1;       % Постоянная времени дифференцирующего звена
Ta = 0.01;      % Постоянная времени фильтра (Ta << Td)

% Передаточная функция ПД-регулятора
num_pd = [kp*Ta+Td, kp];
den_pd = [Ta, 1];
Wp = tf(num_pd, den_pd);

disp('Передаточная функция ПД-регулятора:');
disp(Wp);

% Запуск SISOTool с объектом и регулятором
sisotool(WO, Wp);

% В открывшемся окне SISOTool:
% 1. Добавить ограничения: Settling time < 10s, Overshoot < 10%
% 2. Перемещать нули и полюса регулятора для удовлетворения требований
% 3. Подобрать оптимальные параметры регулятора

%% 4. Анализ полученной системы (пример для проверки)
% Пример параметров после настройки в SISOTool
kp_opt = 0.313;
Td_opt = 0.5;
Ta_opt = 0.313;

% Оптимальный ПД-регулятор
num_pd_opt = [kp_opt*Ta_opt+Td_opt, kp_opt];
den_pd_opt = [Ta_opt, 1];
Wp_opt = tf(num_pd_opt, den_pd_opt);

% Замкнутая система
sys_cl = feedback(Wp_opt*WO, 1);

% Построение переходной характеристики
figure;
step(sys_cl);
title('Переходная характеристика системы с ПД-регулятором');
grid on;

% Определение показателей качества
stepinfo(sys_cl)